!function(e){var n={};function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(o,r,function(n){return e[n]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=0)}([function(e,n,t){e.exports=t(1)},function(e,n){!function(){var e,n,t,o,r,i,a,l,c,d=!1,u=!1,f=!1,s=!1,m=!1,v=!0,b=!1,h=void 0,p=null,g=[],x=null,k=void 0,y="xl_chrome_ext_{4DB361DE-01F7-4376-B494-639E489D19ED}",w=["http.+\\?.*url=.+","http.+\\?.*uri=.+"],E="ED2K://",L="MAGNET:?",C="FTP://THUNDER://MMS://MMST://RTSP://RTSPU://XLAPP://";function _(e,n){return 0!=e.length&&(0!=s&&(0!=function(e){if(0==e.length)return!1;var n=e,t=n.indexOf(":");if(-1==t)return!1;var o=n.substr(0,t+1).toUpperCase();if(""==o)return!1;var r=!0;return-1!=E.indexOf(o)?0==d&&(r=!1):-1!=L.indexOf(o)?0==u&&(r=!1):-1!=C.indexOf(o)?0==f&&(r=!1):r=!1,r}(e)&&(0!=function(e){if(0==e.length)return!0;var n=new Array,t=i.split("||");for(var o in t){var r=t[o].slice(2).trimRight("|");n.push(r)}var a=!0,l=e;for(var c in n)if(n[c].length>0&&-1!=l.indexOf(n[c])){a=!1;break}return a}(n)&&(!function(e){if(0==e.length)return!1;if(0==a.length)return!1;var n=new Array,t=a.split("||");for(var o in t){var r=t[o].slice(2).toLowerCase().trimRight("|");n.push(r)}var i=!1,l=e.toLowerCase();for(var c in n)if(n[c]>0&&-1!=l.indexOf(n[c])){i=!0;break}return i}(n)&&0!=function(e){if(0==e.length)return!1;var n=e.indexOf(":");if(-1==n)return!1;var t=e.toLowerCase();if("xlapp://"==t.substr(0,n+3).trimLeft(" "))return!0;if(-1!=t.indexOf("ed2k://")||-1!=t.indexOf("magnet:?"))return!0;var o,r,i=!1,a=(o=t.replace(/(\\+)/g,"#").split("#"),(r=o[o.length-1].split("."))[r.length-1]);return a.length>0&&(a+=";",-1!=l.indexOf(a)&&(i=!0)),i}(e)))))}function O(e){return n=e,document.cookie,t=document.location.href,!function(e){var n=e.toLowerCase(),t=!0;return-1!=n.indexOf("?")&&-1==n.indexOf("magnet:?")||(t=!1),t}(n)&&_(n,t);var n,t}function M(e){chrome.extension.sendRequest({name:"CheckbMoniterDynamicLinks"},function(e){t=e.bMoniterDynamicLinks})}function R(e){if(!e.ctrlKey&&!t&&n&&o&&r){var i=this.href;if(checkResult=function(e){for(var n in w){var t=new RegExp(w[n],"i").exec(e);if(null!=t)return t}return null}(i),null!=checkResult)return;if(checkResult=O(i),checkResult)return chrome.extension.sendRequest({name:"xl_download",link:i,cookie:document.cookie,referurl:document.location.href}),e.stopPropagation(),void e.preventDefault()}}function D(e,n){var t=!1;do{if(!n)break;var o=n.getBoundingClientRect();if(e.clientX<o.left||e.clientY<o.top||e.clientX>o.right||e.clientY>o.bottom)break;t=!0}while(0);return t}function P(){do{var e=document.getElementById(y);if(!e)break;e.style.display="none"}while(0)}function N(e){do{var n=document.getElementById(y);if(!n)break;m||(m=!0,chrome.extension.sendRequest({name:"VideoShow",referurl:document.location.href},function(){})),n.style.display="block";var t=e.getBoundingClientRect(),o=`position:fixed;left: ${t.x+12}px; top: ${t.y+12}px; width: 98px; height: 24px; z-index: 1000000;`;n.style=o}while(0)}function T(){chrome.extension.onMessage.addListener(function(a,l,c){var d,u;"UpdatePluginEnabled"==a.name?(n=a.enable)&&v?K():V():"UpdateMoniterVideoTags"==a.name?(v=a.enable,n&&v?K():V()):"UpdateMoniterDynamicLinks"==a.name?t=a.enable:"UpdateWebsiteEnabled"==a.name?o=a.enable:"UpdatePageEnabled"==a.name?r=a.enable:"OnActivated"==a.name?e&&(d=document.location.href,u=a.tabId,chrome.extension.sendRequest({name:"CheckEnabled",url:d,tabId:u},function(e){n=e.bPlugin,v=e.bMonitorVideo,o=e.bWebsite,r=e.bPage,n&&v?K():V()}),M()):"UpdateMonitorDomains"==a.name?i=a.monitorDomains:"GetCookie"==a.name&&c({cookie:document.cookie})})}function I(e){var n=void 0;do{if(!e)break;if("VIDEO"!==e.tagName.toUpperCase())break;if(e.src){if(0===e.src.toLowerCase().indexOf("blob:"))break;n=e.src;break}if(!e.children||0===e.children.length)break;for(var t=0;t<e.children.length;t++){let o=e.children[t];if("source"===o.tagName.toLowerCase()&&o.src){0!==o.src.toLowerCase().indexOf("blob:")&&(n=o.src);break}}}while(0);return n}function S(e){let n=void 0;for(var t=0;t<e.children.length;t++){let r=e.children[t];if("source"===r.tagName.toLowerCase()&&r.type){var o=r.type.split("/");o.length>0&&(n=o[o.length-1]);break}}return n?`.${n}`:""}function U(e){var n=document.elementFromPoint(e.x,e.y);do{if(!n)break;if(n.tagName.toUpperCase(),"VIDEO"===n.tagName.toUpperCase()){var t=n.src||I(n);if(!t)break;if(0===t.toLowerCase().indexOf("blob:"))break;if(n===x)break;x=n,k=t,N(n);break}if(x){if(!D(e,x)){x=null,k=void 0,P();break}}else{if(0===g.length)break;for(var o=null,r=0;r<g.length;r++){var i=g[r];if("none"!==window.getComputedStyle(i).display)if(D(e,i))if(o)(Number(window.getComputedStyle(i).zIndex)||0)>(Number(window.getComputedStyle(o).zIndex)||0)&&(o=i);else o=i;else if(o)break}if(o){var a=o.src||I(o);a&&0!==a.toLowerCase().indexOf("blob:")&&(x=o,k=a,N(o));break}}}while(0)}function B(e){x&&(x=null,k=void 0,P())}function q(e){U(e)}function j(e){x&&N(x)}function V(){var e=document.getElementById(y);e&&(document.body.removeChild(e),document.body.removeEventListener("mousemove",U,!0),window.self!==window.top&&document.body.removeEventListener("mouseout",B),document.body.removeEventListener("wheel",q),document.removeEventListener("scroll",j),x=null,k=void 0,g=[]),p&&(p.disconnect(),p=null)}function A(){do{if(!x)break;var e=x;if(!k)break;function n(e){var n="";if(e&&e.length>0){var t=e.lastIndexOf(".");-1!==t&&(n=(n=e.substr(t)).toLowerCase())}return n}var t="";if(document.title){var o=document.title.replace(/[*?/:|<>"]/g,"");if(o){var r=n((void 0,i=k.replace(/\?.*$/,"").replace(/.*\//,""),decodeURIComponent(i)));r||(r=S(e)),t=`${o}${r}`}}chrome.extension.sendRequest({name:"xl_download",link:k,cookie:document.cookie,referurl:document.location.href,fileName:t,stat:"chrome_download_video"})}while(0);var i}function $(){var e=document.createElement("div");e.className="xl-chrome-ext-bar",e.style.display="none",e.id=y,e.innerHTML='\n      <div class="xl-chrome-ext-bar__logo"></div>\n\n      <a id="xl_chrome_ext_download" href="javascript:;" class="xl-chrome-ext-bar__option">下载视频</a>\n      <a id="xl_chrome_ext_close" href="javascript:;" class="xl-chrome-ext-bar__close"></a>\n    ',document.body.appendChild(e);for(var n=e.getElementsByTagName("a"),t=0;t<n.length;t++){n[t].addEventListener("click",e=>{do{if(!e)break;if(!e.target)break;switch(e.target.id){case"xl_chrome_ext_download":e.preventDefault(),A();break;case"xl_chrome_ext_close":e.preventDefault(),V(),h=!0}}while(0)},!1)}document.body.addEventListener("mousemove",U,!0),window.self!==window.top&&document.body.addEventListener("mouseout",B),document.body.addEventListener("wheel",q),document.addEventListener("scroll",j)}function F(){do{if(p)break;var e=null;try{e=window.top.document.getElementsByTagName("title")[0]}catch(e){}e&&(p=new MutationObserver(function(e){var n=document.getElementsByTagName("video");g=n})).observe(e,{childList:!0});var n=document.getElementsByTagName("video");g=n}while(0)}function K(){do{if(!n)break;if(!v)break;if(!b)break;if(h)break;V(),F(),$()}while(0)}e=!0,T(),c=document.location.href,chrome.extension.sendRequest({name:"CheckActivated",url:c}),M(),function(){for(var e=0;e<document.links.length;e++)document.links[e].addEventListener("click",R,!1)}(),document.addEventListener("DOMContentLoaded",function(){var e;e=document.location.href,chrome.extension.sendRequest({name:"CheckVideoInWhiteList",url:e},function(e){b=e.videoInWhiteList,n=e.bPlugin,v=e.bMonitorVideo,n&&v&&K()})}),document.addEventListener("keydown",function(e){e.ctrlKey&&chrome.extension.sendRequest({name:"EnabledCapture",capture:!1},function(){})}),document.addEventListener("keyup",function(e){e.ctrlKey&&chrome.extension.sendRequest({name:"EnabledCapture",capture:!0},function(){})}),chrome.extension.sendRequest({name:"GetConfig"},function(e){d=e.bMonitorEmule,u=e.bMonitorMagnet,f=e.bMonitorTradition,s=e.bMonitorIE,i=e.monitorDomains,a=e.filterDomains,l=e.monitorFileExts})}()}]);
//# sourceMappingURL=xl-content.js.map